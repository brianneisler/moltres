language: node_js
sudo: false
node_js:
  - 16
  - 14
  - 12
  - 10
os:
  - linux
  - osx
  - windows
install:
  - npm run setup
script:
  - npm run test-ci
stages:
  - audit
  - lint
  - test
  - name: deploy
    if: tag=~^v AND repo=brianneisler/moltres
jobs:
  include:
    - stage: audit
      node_js: 14
      os: linux
      script: npm run security-audit
    - stage: lint
      node_js: 14
      os: linux
      script: npm run lint-ci
    - stage: deploy
      node_js: 14
      os: linux
      script: echo "Deploying to npm ..."
      deploy:
        provider: npm
        skip_cleanup: true
        email: me@brianneisler.com
        api_key: '$NPM_API_KEY'
        on:
          tags: true
env:
  global:
    secure: ViGfZQiZHT3C/JzgkcRMt7RI/xqp1Tj6hvEUH1a0KIH5hT0vTlZFV7A0xB8ALk3ejQsIii6JUhaLgUDwSIDpnhhQw6L2wVwYp7d7KreD9UPuWk7qFQQQZ0WNPPUGSDOI/MYmQ1Z6AQ+OQApchQ8/To9VTsxTvC+FDriedlHI1XsENuFmkfzVFo7X2KUcq4o2MtIHLmxsZIsd1wF69JKmmMg5JGyXqJDKDLcb9MPM8njh7MgrP6vQAm3Re3QUNpeI+p+yXu4S4XPIHTOPdSwatnGscIh2NMrVVS6HKiwBOvOx1jZx3NcLBfTSXA9wjU10W0OYfv0Szaxlf9WszAFrN6/TUCv2pbBifbg6kXUl4deP1ISQ+v2zvzV+S+eE/NC3S9GVRm6DL3viwe+icN6uWaEmq/Rxg404h+7lsirFHypOgFQOvQKrnS1WU6AYk6RtXQWLTwTpZCABFX0mat03toJMlDEutO7YlVTevPOW1EH2imCibW82qicmitfHbkDYSKPqmOHuqnug1CzfFLChRduRPUq0MyMtvV41Nrj0O2bsAodmRmKhKIZmYUhxOaUVanmRLXNdgY4XoB98DuZYqOVh0E/v8q9h7rx2gt2q40z6FiwuZO6pqMI1hBfxVDf82/YqAl+gmw5X/ZMm/LQqlckxKPP47kWtHIG7FP5/TfU=
